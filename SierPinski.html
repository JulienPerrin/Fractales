<!DOCTYPE html>
<html>
  <head>
    <title>SierPinski</title>
	<style type="text/css">
		canvas { border: 1px solid black; }
	</style>
	<script>
		function equilateralHeight(width) {
			return Math.floor(Math.sqrt(width*width-(width/2)*(width/2))); 
		}
		function calculateNbIteration(width) {
			return width * (3 ** (Math.log(width)));
		}
		function sleep(ms) {
			return new Promise(resolve => setTimeout(resolve, ms));
		}
	</script>
  </head>
  <body onload="draw()">
	<div>
		<p>Cette page utilise un algorithme simple pour dessiner le triangle de SierPinski. Pour faire varier le nombre de pixels simul√©s, modifier la valeur "width" du canvas et recharger la page. </p>
		<canvas id="fractale" width="1500" height="" style="width:600px; "></canvas>
	</div>
  </body>
  <script>
		function draw(){
			var canvas = document.getElementById('fractale');
			if (canvas.getContext){
				var ctx = canvas.getContext('2d');
				ctx.fillStyle = "blue";
				var width = canvas.width;
				canvas.height = equilateralHeight(width);
				var height = canvas.height;
				
				var id = ctx.createImageData(1,1); // only do this once per page
				var d  = id.data;       			// only do this once per page
				d[0]   = 192;//r
				d[1]   = 192;//g
				d[2]   = 192;//b
				d[3]   = 255;//a: transparency, 0..255
				
				var x = 0;
				var y = 0;
				
				var xa = width, ya=height, xb=0, yb=height;
				var xc = width/2;
				var yc = height-equilateralHeight(width);
				var aleatoire;
				
				var nbIter = calculateNbIteration(width);
					
				ctx.beginPath();
				for (i = 0; i<nbIter; i++) {
					ctx.moveTo(x, y);
					aleatoire = Math.floor((Math.random() * 3));
					switch(aleatoire) { 
						case 0 : 
							x = 0.5*(x+xa); 
							y = 0.5*(y+ya);
							break;
						case 1 : 
							x = 0.5*(x+xb);
							y = 0.5*(y+yb);
							break;
						case 2 : 
							x = 0.5*(x+xc);
							y = 0.5*(y+yc);
							break;
					}
					ctx.putImageData(id, x, y);  
					//await sleep(0.1);
				}
			}
		}
	</script>
</html>
